{% extends "sistema_2/layout_3.html" %}

{% load static %}

{% block code %}

<link href="https://cdn.datatables.net/1.12.1/css/dataTables.bootstrap5.min.css" rel="stylesheet">
<script src="https://code.jquery.com/jquery-3.5.1.js"></script>
<script src="https://cdn.datatables.net/1.12.1/js/jquery.dataTables.min.js"></script>
<script src="https://cdn.datatables.net/1.12.1/js/dataTables.bootstrap5.min.js"></script>

<script src="https://cdn.jsdelivr.net/npm/bootstrap-select@1.14.0-beta2/dist/js/bootstrap-select.min.js"></script>
<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-select@1.14.0-beta2/dist/css/bootstrap-select.min.css">


{% endblock %}


{% block content%}
<div class="container" style="height: 100vh;overflow: scroll;">
    <div class="row">
        <div class="col-8">
            <h1>Configuracion de comisiones</h1>
        </div>
    </div>
    <div class="row mt-3">
        <div class="col-1">
            <a class="btn btn-primary" href="{% url 'sistema_2:comisiones' %}"><i class="fa fa-arrow-left"></i></a>
        </div>
        <div class="col-2">
            <button class="btn btn-success" data-bs-toggle="modal" data-bs-target="#nuevaConfig"><i class="fa fa-plus"></i> Agregar</button>
        </div>
    </div>
    <div class="row justify-content-around mt-4">
        <div class="col-8">
            <table class="table table-bordered">
                <thead class="table-dark">
                    <th>Usuario</th>
                    <th>Fecha de registro</th>
                    <th>Porcentaje de comision</th>
                    <th>Â¿Incluye IGV?</th>
                    <th>Editar</th>
                    <th>Eliminar</th>
                </thead>
                <tbody>
                    {% for configuracion in configuracionesTotales %}
                    <tr class="text-center">
                        <td>{{ configuracion.usuarioRelacionado.username }}</td>
                        <td>{{ configuracion.fechaRegistro|date:"d-m-Y" }}</td>
                        <td>{{ configuracion.porcentajeComision }} %</td>
                        <td>
                            {% if configuracion.incluyeIgv == '1' %}
                            <p class="bg-success mx-4 text-white" style="border-radius: 5px;">Si</p>
                            {% else %}
                            <p class="bg-danger mx-4 text-white" style="border-radius: 5px;">No</p>
                            {% endif %}
                        </td>
                        <td><button class="btn btn-warning"><i class="fa fa-edit"></i></button></td>
                        <td><a class="btn btn-danger" href="{% url 'sistema_2:eliminarConfiguracionComisiones' configuracion.id %}"><i class="fa fa-trash"></i></a></td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </div>
</div>

<!-- Modal -->
<div class="modal fade" id="nuevaConfig" data-bs-backdrop="static" data-bs-keyboard="false">
    <div class="modal-dialog">
        <div class="modal-content">
            <form method="post" action="{% url 'sistema_2:configComisiones' %}">
                <div class="modal-header">
                    <h5 class="modal-title">Nueva configuracion</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <div class="row mt-3 mb-3 justify-content-around">
                        <div class="col-5">
                            <label>Seleccione el usuario</label>
                            <select class="form-control selectpicker" data-live-search="true" name="usuarioSeleccionado" required>
                                <option value=""></option>
                                {% for usuario in usuariosTotales %}
                                <option value="{{ usuario.id }}">{{ usuario.username }}</option>
                                {% endfor %}
                            </select>
                        </div>
                        <div class="col-5">
                            <label>Porcentaje de comision</label>
                            <input type="number" step="1" value="0" class="form-control" name="porcentajeComision" required>
                        </div>
                    </div>
                    <div class="row mb-3 justify-content-around">
                        <div class="col-5">
                            <input class="form-check-input" type="checkbox" value="on" name="incluyeIgv">
                            <label class="form-check-label">Incluye IGV</label>
                        </div>
                        <div class="col-5"></div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                    <button type="submit" class="btn btn-primary">Registrar</button>
                </div>
            </form>
        </div>
    </div>
</div>


{% endblock %}